window.RQ=window.RQ||{},RQ.configs={browser:["chrome","firefox"][0],env:["local","beta","prod"][2],version:"5.0.0"};var envConfigs={local:{WEB_URL:"http://localhost:3000"},beta:{WEB_URL:"https://beta.requestly.in"},prod:{WEB_URL:"https://www.requestly.in"}},browserConfigs={chrome:{storageType:"sync",contextMenuContexts:["browser_action"]},firefox:{storageType:"local",contextMenuContexts:["all"]}};Object.assign(RQ.configs,envConfigs[RQ.configs.env],browserConfigs[RQ.configs.browser]),window.RQ=window.RQ||{},RQ.VERSION=3,RQ.VERSIONS={REPLACE_RULE:2},RQ.RULES_PAGE_URL=RQ.configs.WEB_URL+"/rules/",RQ.RULES_PAGE_URL_PATTERN=RQ.RULES_PAGE_URL+"*",RQ.BLACK_LIST_DOMAINS=["requestly.in"],RQ.STRING_CONSTANTS={SLASH:"/"},RQ.LIMITS={NUMBER_SHARED_LISTS:10},RQ.RULE_TYPES={REDIRECT:"Redirect",CANCEL:"Cancel",REPLACE:"Replace",HEADERS:"Headers",USERAGENT:"UserAgent",SCRIPT:"Script"},RQ.HEADER_NAMES={USER_AGENT:"User-Agent"},RQ.RULE_STATUS={ACTIVE:"Active",INACTIVE:"Inactive"},RQ.RULE_KEYS={URL:"Url",HOST:"host",PATH:"path",HEADER:"Header"},RQ.RULE_OPERATORS={EQUALS:"Equals",CONTAINS:"Contains",MATCHES:"Matches",WILDCARD_MATCHES:"Wildcard_Matches"},RQ.MODIFICATION_TYPES={ADD:"Add",REMOVE:"Remove",MODIFY:"Modify",REPLACE:"Replace"},RQ.HEADERS_TARGET={REQUEST:"Request",RESPONSE:"Response"},RQ.REQUEST_TYPES={MAIN_FRAME:"mainFrame",PAGE_REQUEST:"pageRequest"},RQ.SCRIPT_TYPES={URL:"url",CODE:"code"},RQ.SCRIPT_LOAD_TIME={BEFORE_PAGE_LOAD:"beforePageLoad",AFTER_PAGE_LOAD:"afterPageLoad"},RQ.SCRIPT_LIBRARIES={JQUERY:{name:"jQuery",src:"https://code.jquery.com/jquery-2.2.4.js"},UNDERSCORE:{name:"Underscore",src:"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"}},RQ.RESPONSE_CODES={NOT_FOUND:404},RQ.STORAGE_KEYS={REQUESTLY_SETTINGS:"rq_settings",USER_INFO:"user_info",LATEST_NOTIFICATION_READ_BY_USER:"latestNotificationReadId"},RQ.MESSAGES={DELETE_ITEMS:"Are you sure you want to delete the selected items ?",SIGN_IN_TO_VIEW_SHARED_LISTS:"Please login with Google to view your Shared Lists.",ERROR_AUTHENTICATION:"Received some error in authentication. Please try again later!!",SHARED_LISTS_LIMIT_REACHED:"You can not create more than "+RQ.LIMITS.NUMBER_SHARED_LISTS+" shared lists",DEACTIVATE_REQUESTLY_MENU_OPTION:"Deactivate Requestly"},RQ.RESOURCES={EXTENSION_ICON:"/resources/images/38x38.png",EXTENSION_ICON_GREYSCALE:"/resources/images/38x38_greyscale.png"},RQ.GA_EVENTS={CATEGORIES:{RULES:"rules",USER:"user",SHARED_LIST:"shared list",EXTENSION:"extension"},ACTIONS:{MODIFIED:"modified",CREATED:"created",DELETED:"deleted",ACTIVATED:"activated",DEACTIVATED:"deactivated",IMPORTED:"imported",EXPORTED:"exported",LIMIT_REACHED:"limit reached",AUTHENTICATED:"authenticated",VIEWED:"viewed"}},RQ.USER={AUTHORIZED:"authorized-user",UNAUTHORIZED:"unauthorized-user"},RQ.FIREBASE_NODES={USERS:"users",PUBLIC:"public",SHARED_LISTS:"sharedLists"},RQ.DATASTORE={ACTIONS:{CHECK_USER_AUTH:"check:userAuthenticated",AUTHENTICATE:"authenticate",GETVALUE:"getValue",SETVALUE:"setValue"}},RQ.htmlEncode=function(a){return $("<div/>").text(a).html()},RQ.getSharedURL=function(a){return RQ.RULES_PAGE_URL+"#sharedList/"+a},RQ.Utils=RQ.Utils||{},RQ.Utils.executeScript=function(a){var b=document.createElement("script");return b.type="text/javascript",b.appendChild(document.createTextNode(a)),document.head.appendChild(b),b},RQ.Utils.injectScript=function(a,b){var c=document.createElement("script");return c.type="text/javascript",c.src=a,c.readyState?c.onreadystatechange=function(){"loaded"!==c.readyState&&"complete"!==c.readyState||(c.onreadystatechange=null,b())}:c.onload=b,document.head.appendChild(c),c},RQ.ScriptRuleHandler={},RQ.ScriptRuleHandler.handleRules=function(a){for(var b=0;b<a.length;b++)RQ.ScriptRuleHandler.handleRule(a[b])},RQ.ScriptRuleHandler.handleRule=function(a){var b=a.pairs[0],c=this,d=function(){b.scripts.length>0&&c.addCustomScripts(b.scripts)};b.libraries.length>0?this.addLibraries(b.libraries,d):d()},RQ.ScriptRuleHandler.addLibraries=function(a,b,c){(c=c||0)>=a.length&&b();var d=a[c],e=RQ.SCRIPT_LIBRARIES[d],f=RQ.ScriptRuleHandler.getLibraryScriptId(d);if(e&&!document.getElementById(f)){var g=RQ.Utils.injectScript(e.src,function(){RQ.ScriptRuleHandler.addLibraries(a,b,c+1)});g.id=f,g.className=RQ.ScriptRuleHandler.getScriptClassAttribute()}},RQ.ScriptRuleHandler.addCustomScripts=function(a){for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d];e.loadTime===RQ.SCRIPT_LOAD_TIME.BEFORE_PAGE_LOAD?b.push(e):e.loadTime===RQ.SCRIPT_LOAD_TIME.AFTER_PAGE_LOAD&&c.push(e)}RQ.ScriptRuleHandler.executeScriptsInOrder(b),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){RQ.ScriptRuleHandler.executeScriptsInOrder(c)}):RQ.ScriptRuleHandler.executeScriptsInOrder(c)},RQ.ScriptRuleHandler.executeScriptsInOrder=function(a,b){if(!((b=b||0)>=a.length)){var c=a[b],d=function(){RQ.ScriptRuleHandler.executeScriptsInOrder(a,b+1)};if(c.type===RQ.SCRIPT_TYPES.URL){var e=c.value;if(e){return void(RQ.Utils.injectScript(e,d).className=RQ.ScriptRuleHandler.getScriptClassAttribute())}}else if(c.type===RQ.SCRIPT_TYPES.CODE){var f=c.value;f&&RQ.Utils.executeScript(f)}d()}},RQ.ScriptRuleHandler.getLibraryScriptId=function(a){return"RQ_LIB_"+a},RQ.ScriptRuleHandler.getScriptClassAttribute=function(){return"RQ_SCRIPT"},chrome.runtime.sendMessage({url:window.location.href,ruleType:RQ.RULE_TYPES.SCRIPT},function(a){a&&a.constructor===Array&&RQ.ScriptRuleHandler.handleRules(a)}),chrome.runtime.onMessage.addListener(function(a,b,c){var d=a.selectorObj;if("evaluateSelector"==a.action){var e=document.querySelectorAll(d.selector);e&&e.length>d.index?"a"===d.type&&c({value:e[d.index].getAttribute(d.attr)}):c()}});